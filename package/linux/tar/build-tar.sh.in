#!/bin/bash

set -e

THIS_DIR=${CMAKE_CURRENT_BINARY_DIR}
TAR_DIR=${CMAKE_CURRENT_BINARY_DIR}/tar
OUT_DIR=${NJ_PUBLISH_DIR}
OUT_FILE_NAME=ioninja-linux-${TARGET_CPU}-${NJ_VERSION_FILE_SUFFIX}.tar.gz
OUT_FILE_PATH=$OUT_DIR/$OUT_FILE_NAME

echo Building TAR archive $OUT_FILE_NAME...

. $THIS_DIR/../prepare-contents
prepare_contents $TAR_DIR

mkdir -p $OUT_DIR
tar -czf $OUT_FILE_PATH -C $TAR_DIR .
rm -rf $TAR_DIR
